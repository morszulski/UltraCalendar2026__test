<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultra Calendar 2026</title>
<link rel="stylesheet" href="styles.css">
<style>
  body { font-family: Arial, sans-serif; background: #f7f7f7; margin:0; padding:20px; }
  #root { max-width: 1000px; margin: auto; }
  h1 { text-align: center; margin-bottom: 30px; }

  .controls { display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 20px; }
  .filters { display: flex; align-items: center; flex-wrap: wrap; gap: 10px; }
  select, input { padding: 5px; margin-left: 5px; }

  .view-buttons button { margin-right: 10px; padding: 5px 10px; cursor: pointer; }
  .view-buttons button.active { background-color: #007bff; color: white; border: none; border-radius: 4px; }

  .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  .calendar-header button { padding: 5px 10px; cursor: pointer; }
  .month { font-weight: bold; font-size: 1.6em; min-width: 200px; text-align: center; }

  .event-card { background: white; border-radius: 8px; padding: 10px 15px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  .event-card a { text-decoration: none; color: #007bff; font-weight: bold; }
  .event-card a:hover { text-decoration: underline; }
  .event-details { font-size: 0.9em; color: #555; margin-top: 5px; }

  @media (max-width:600px){
    .controls { flex-direction: column; gap:10px; }
    .filters { flex-wrap: wrap; }
  }
</style>
</head>
<body>
<h1>Ultra Calendar 2026</h1>
<div id="root"></div>

<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="events.js"></script>

<script type="text/babel">
const MONTH_NAMES = ["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"];

function App() {
  const [view, setView] = React.useState('list'); // 'list' lub 'calendar'
  const [filterType, setFilterType] = React.useState('');
  const [filterMinDistance, setFilterMinDistance] = React.useState('');
  const [filterMaxDistance, setFilterMaxDistance] = React.useState('');

  const firstEventDate = React.useMemo(() => {
    if (EVENTS.length === 0) return new Date();
    const dates = EVENTS.map(e => new Date(e.dateStart));
    return new Date(Math.min(...dates));
  }, []);

  const [currentMonth, setCurrentMonth] = React.useState(firstEventDate.getMonth());
  const [currentYear] = React.useState(firstEventDate.getFullYear());

  const filteredEvents = React.useMemo(() => {
    return EVENTS.filter(e => {
      if (filterType && !e.types.includes(filterType)) return false;
      if (filterMinDistance && Math.max(...e.distances) < parseInt(filterMinDistance)) return false;
      if (filterMaxDistance && Math.min(...e.distances) > parseInt(filterMaxDistance)) return false;
      return true;
    });
  }, [filterType, filterMinDistance, filterMaxDistance]);

  const eventsByMonth = React.useMemo(() => {
    const map = {};
    filteredEvents.forEach(e => {
      const month = new Date(e.dateStart).getMonth();
      if (!map[month]) map[month] = [];
      map[month].push(e);
    });
    return map;
  }, [filteredEvents]);

  const handlePrevMonth = () => setCurrentMonth((currentMonth + 11) % 12);
  const handleNextMonth = () => setCurrentMonth((currentMonth + 1) % 12);

  const renderEventCard = (e) => (
    <div key={e.id} className="event-card">
      {e.url ? <a href={e.url} target="_blank" rel="noopener noreferrer">{e.title}</a> : <span>{e.title}</span>}
      <div className="event-details">
        {e.dateStart}{e.dateEnd ? ` – ${e.dateEnd}` : ''} | Typ: {e.types.join(', ')} | Dystans: {e.distances.join('/')} km
      </div>
    </div>
  );

  return (
    <div>
      <div className="controls">
        <div className="view-buttons">
          <button className={view==='list'?'active':''} onClick={()=>setView('list')}>Lista</button>
          <button className={view==='calendar'?'active':''} onClick={()=>setView('calendar')}>Kalendarz</button>
        </div>
        <div className="filters">
          Typ roweru:
          <select value={filterType} onChange={e=>setFilterType(e.target.value)}>
            <option value="">Wszystkie</option>
            <option value="Sz">Szosa</option>
            <option value="G">Gravel</option>
            <option value="M">MTB</option>
            <option value="E">Electric</option>
            <option value="B&R">BikeRafting</option>
          </select>
          Dystans min:
          <input type="number" value={filterMinDistance} onChange={e=>setFilterMinDistance(e.target.value)} style={{width:'60px'}} />
          max:
          <input type="number" value={filterMaxDistance} onChange={e=>setFilterMaxDistance(e.target.value)} style={{width:'60px'}} />
        </div>
      </div>

      {view==='list' ? (
        <div>
          {filteredEvents.length === 0 && <div>Brak wydarzeń spełniających kryteria</div>}
          {filteredEvents.map(renderEventCard)}
        </div>
      ) : (
        <div>
          <div className="calendar-header">
            <button onClick={handlePrevMonth}>◀</button>
            <div className="month">{MONTH_NAMES[currentMonth]} {currentYear}</div>
            <button onClick={handleNextMonth}>▶</button>
          </div>
          <div>
            {(eventsByMonth[currentMonth] || []).length === 0 && <div>Brak wydarzeń w tym miesiącu</div>}
            {(eventsByMonth[currentMonth] || []).map(renderEventCard)}
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
